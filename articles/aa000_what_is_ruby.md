AllAbout: aa002: Rubyとは
===============================

## こんてんつ

* Rubyとは何か
* Rubyの特徴とコード例
* Rubyを始める人のための参考資料


## Rubyとは何か

Rubyは, 1990年代に開発・公開されたオブジェクト指向のプログラミング言語で, 生みの親はソフトウェア技術者のまつもとゆきひろ (通称 Matz) さんです.

「プログラミングを楽しむ」という哲学のもとに言語仕様が決められており, 初学者を含めた多くの人にとって「読みやすく書きやすい」文法なのではないかと思います (もちろん人それぞれ好みがありますが).

また実用的なライブラリが標準で付属しており, ちょっとしたタスクをこなす普段使い言語としても比較的使い勝手が良くなっています.
たとえば以下のスクリプトは「AllAboutトップページに表示されている画像を保存する」処理を実行します. (ここで最初に示すスクリプトとしてもっと良い例を模索中...)


<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-01.rb"></script>



2013年にまつもとゆきひろ氏が講演の中で[「Rubyは言語として2.0でほぼ完成」](http://itpro.nikkeibp.co.jp/article/NEWS/20130214/456322/) と述べているように, ある程度成熟してきている言語なので, 今後バージョンアップで言語が劇的に変化して覚えたことが無駄になる可能性は低いでしょう.

Rubyのプロダクトとしては, [Ruby on Rails](http://rubyonrails.org/) という人気フレームワークがあります(Railsについては回を改めて紹介する予定です). このRailsの後押しもあり, RubyはWebプログラミングでよく使われていまが, Rubyの活躍する分野はWebだけではありません.


組み込みシステムで使える [mruby](https://github.com/mruby/mruby) や RubyでiOSアプリを作る[RubyMotion](http://www.rubymotion.com/) など, ターゲットを広げながら今では世界中で使われています. 日本発祥のプログラミング言語のため, 日本語の情報が充実していて学習のハードルが低いことも初学者には嬉しい要素です.

次のページでは, プログラミング言語としてのRubyの特徴を挙げていきます.


## Rubyの特徴とコード例

プログラミング言語としてのRubyを百科事典的に一言で表すならば「オブジェクト指向のスクリプト言語」と言えるでしょうか. Rubyの特徴として挙げられるのは次のようなものです.

* すべてはオブジェクト
* 変数に型がない(動的型付け)
* オープンクラス
* クラスの単一継承とMix-in
* クロージャを扱う構文(ブロック, Proc, lambda)

以下ではコード例を示しつつ, これらの特徴について簡単に紹介します. まず今回の記事ではなんとなく眺めて, Rubyの雰囲気を掴んでもらえればと思います.


### すべてはオブジェクト

Rubyのオブジェクト指向は徹底されており, (ごく一部の例外を除き) すべてのものが「オブジェクト」, すなわち何らかのクラスのインスタンスになっています. Javaのプリミティブ型のようなものはありません.

<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-02.rb"></script>


### 変数に型がない(動的型付け)

変数を使う前に宣言は必要ありません. さらに, 変数にどんな型を入れてもエラーにはならず, 何度でも再代入可能です.

<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-03.rb"></script>


この特性は柔軟かつ素早いコーディングを可能にする一方で, 静的型付け言語に比べてバグを生みやすいというデメリットもあります. ここは好き嫌いの別れるところかもしれません.
ちなみにRubyistはこのデメリット(コードが柔軟なのでバグを生みやすい)に自覚的であり, バグを防ぐために「テストを書く」ことが基本文化として浸透しているのは良いことだと言えるでしょう.


### オープンクラス

Rubyにとってクラスは「固定された」ものではありません. プログラマは好きなときにクラスを"オープン"し, 機能拡張することができます.

具体的にはクラスを宣言するのと同じように"class Hoge"を使うだけです. もしHogeが既存のクラスの時は, 定義が上書きされるのではなく, 定義済みのクラスに実装が"追加"されます.


<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-06.rb"></script>


上の例で見たようString等の標準クラスはもちろん, 自分で定義したクラスも自在に拡張できます. このように「言語を使うプログラマを信頼し, 大きな(そして場合によっては危険な)力を与える」というのも, Ruby言語仕様の特徴の一つです.


### クラスの単一継承とMix-in

Rubyのオブジェクト指向システムはクラスベースで設計されており, クラスは「継承」することが出来ます.
Rubyにおけるクラスの継承は, クラスの宣言時に "class ChildClass < ParentClass" のように記述することで実現します.

継承を説明する古典的な例として, 動物のクラス定義を考えてみます.

<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-04.rb"></script>


さて, 実際のコードではシンプルな単一継承関係で話が終わることは稀です. どうしても複数の機能を抽象化したいケースが出てきます. 親クラスを複数持つ継承スタイルを「多重継承」と呼びます.

ところが, 多重継承を許すといろいろな不都合が起こることがわかって来ました. 1990年代以降に生まれた言語の多くは失敗の歴史を踏まえ, 多重継承の不都合を避けつつメリットだけを享受しようと試行錯誤してきました.

Rubyは多重継承を許しません. つまりクラスの親クラスは必ず一つです. Rubyが多重継承の代わりに採用したのは, Lispのオブジェクト指向機能から生まれた"Mix-in"という方法でした.


例として, クジラにSwim機能を加えてみましょう. ネコは多少泳げるかもしれませんが, まぁここではクジラだけ泳げるという前提で考えます.

Whaleクラスに"include" という宣言SwimモジュールをMix-inします.

<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-05.rb"></script>


このようにして, Rubyのクラスは継承関係の外からも機能を"つまみ食い"的に取り込むことが出来ます.


### クロージャを扱う構文(ブロック, Proc, lambda)


最後に, このテーマは本格的に説明すると2,3回の連載でガッツリ扱えるほど濃厚なので, 軽く触れる程度にします.

Rubyにもforやwhileは定義されていますがあまり使われず, その代わりにブロック付きのイテレータで繰り返し処理を書くことが多いです.

ブロックは "do...end" もしくは "{...}" で記述します.

<script src="https://gist.github.com/memerelics/00f2a011c7c4970fe0ea.js?file=aa000-07.rb"></script>

